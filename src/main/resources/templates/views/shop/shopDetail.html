<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <script type="text/javascript" src="https://chir.ag/projects/ntc/ntc.js"></script>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <style>
    .fixed-top{
        position: fixed;
        top: 0; /* ÌôîÎ©¥ Ï†ÑÏ≤¥ ÎÑàÎπÑÏóê ÎßûÍ≤å ÏÑ§Ï†ï */
        background-color: white; /* ÌïÑÏöîÏóê Îî∞Îùº Î∞∞Í≤Ω ÏÉâÏÉÅ Ï∂îÍ∞Ä */
        z-index: 100; /* ÌïÑÏöîÏóê Îî∞Îùº z-index Ï°∞Ï†à */
        width:auto;
    }

	.sumDiv {
		height: 80%;
	}

    .product-image {
    	 width: 100%;
         height: 100%;
     }

    .img-thumbnail {
         height: 800px;
         width: auto;
    }

    .btn-outline-success.btn-lg {
        font-size: 1.5rem;
        padding: 0.75rem 1.25rem;
    }

    .product_btns {
        align-items: center;
        top: 0;
        right: 0;
        margin: 10px;
    }

    .product_btns > * {
        margin-bottom: 10px;
        width: 100%;
        max-width: 150px;
    }
        
    
    .colors {
    	pointer-events: none;
    }
    
    .colorsName{
    	width: 78px;
    	height: 27px;
    	font-size: 12px;
    	border: none;
  		background: transparent;
    }

	.drop-menu {
      display: none;
      position: absolute;
      background-color: #fff;
      min-width: 80px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      z-index: 1;
      list-style-type: none;
      margin: 2px;
      padding-left: 0px;
    }

    .drop-menu.show {
      display: block;
      
    }

    .drop-item {
      display: block;
      width: 100%;
      padding: 5px;
      text-align: left;
      border: none;
      background: none;
      cursor: pointer;
      padding-left: 15px;
      
    }
    
    .drop-item:hover{
    	background: silver;
    }
    </style>
</head>
<body>
    <!-- tap -->
    <div th:replace="~{common/top :: top}"></div>
    <main>
        <div class="container">
            <div class="d-flex justify-content-center">
                <div class="row">
                	<th:block th:each="t, i: ${tList}">
	                    <div class="col"  th:if="${i.index == 0}">
	                        <img class="product-image img-thumbnail rounded mx-auto d-block" th:src="'/image/shopFiles/' + ${ t.renameName }" alt="ÏÉÅÌíàÏù¥Î¶Ñ" width="80%">
	                    </div>
	                </th:block>
                    <div class="row" >
	                    <div class="sumDiv col" th:each="t, i: ${tList}" th:if="${i.index > 0}">
	                        <img class="product-image m-1 p-1" th:src="'/image/shopFiles/' + ${ t.renameName }" width="20%">
	                    </div>
                    </div>
                </div>
                
                <!-- Î≤ÑÌäº Îî∞ÎùºÏÑú action Î≥ÄÍ≤Ω -->
                <div class="product m-2 col-4">
              		<form id="productForm">
              			<input type="hidden" th:value="${p.productId}" name="productId">
              			<input type="hidden" value="N" name="isMove" id="isMove">
              			<input type="hidden" th:value="${page}" name="page">
	                    <div class="product_info border-1 border-secondary border-bottom">
	                        <div class="fw-bold row">
	                            <p class="fs-2 col-10" th:text="${p.productName}"></p>
	                            <!-- Í¥ÄÎ¶¨ÏûêÏïÑÏù¥Îîî Ïùº ÎïåÎßå -->
	                            <p class="col-2" th:if="${ session.loginUser != null && session.loginUser.isAdmin == 'Y'}">
	                            	<button type="button" class="btn btn-outline-dark btn-sm p-1 m-1" id="editBtn">Edit</button>
	                            </p>
	                        </div>
	                        <div id="stampImgParent">
	                            <p class="fs-4">
	                            	<span class="reviewWord">Î¶¨Î∑∞ : [[${rList.size}]]Í±¥</span> /
	                            	<span class="stampWord">Ï∞úÌïòÍ∏∞ : [[${savedCount}]]Í±¥ </span>
	                            	<span class="stampImg isFill" th:unless="${stampCount == 0}">‚ù§</span>
	                            	<span class="stampImg isEmpty" th:if="${stampCount == 0}">ü§ç</span>
	                            </p>
	                        </div>
	                        <div>
	                            <p class="fs-4">Í∞ÄÍ≤© : [[${#numbers.formatInteger(p.price, 3, 'COMMA')}]]Ïõê</p>
	                        </div>
	                    </div>
	                    <ul class="list-unstyled pt-4">
	                        <li class="fs-3 d-flex p-2 justify-content-between">
	                            <div class="fw-bold">Î∞∞ÏÜ°Ï†ïÎ≥¥</div>
	                            <div id="deli" class="fs-4"></div>
	                        </li>
	                         <li class="fs-3 d-flex p-2 justify-content-between">
	                        	<div class="fw-bold">ÌòÑÏû¨ ÎÇ®ÏùÄ ÏàòÎüâ</div>
	                        	<div class="fs-4">[[${#numbers.formatInteger(p.quantity, 3, 'COMMA')}]]Í∞ú</div>
	                        </li>
	                        <li class="fs-2 pt-4 d-flex justify-content-between">
	                            <div class="fw-bold">ÏÇ¨Ïù¥Ï¶à</div>
	                            <div class="sizeSelect" th:if="${p.usedStandard == 'Y'}">
	                                <input type="radio" class="btn-check" name="pSize" id="optionS" autocomplete="off" value="S" checked>
	                                <label class="btn btn-outline-success btn-lg" for="optionS">S</label>
	                                <input type="radio" class="btn-check" name="pSize" id="optionM" autocomplete="off" value="M">
	                                <label class="btn btn-outline-success btn-lg" for="optionM">M</label>
	                                <input type="radio" class="btn-check" name="pSize" id="optionL" autocomplete="off" value="L">
	                                <label class="btn btn-outline-success btn-lg" for="optionL">L</label>
	                                <input type="radio" class="btn-check" name="pSize" id="optionXL" autocomplete="off" value="XL">
	                                <label class="btn btn-outline-success btn-lg" for="optionXL">XL</label>
	                            </div>
	                            <div class="sizeSelect" th:unless="${p.usedStandard == 'Y'}">
	                            	<span class="fs-5 fw-bold">ÏÇ¨Ïù¥Ï¶à Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§.</span>
	                            </div>
	                        </li>
	                        
	                        <li class="fs-3 d-flex p-2 justify-content-between">
	                        	
	                        	<div class="fw-bold">ÏÉâÏÉÅ Ï†ïÎ≥¥</div>
	                        	<div class="asdasdasd d-flex">
		                        	<div th:if="${colors != null}" class="colorSelect">
		                        		<th:block  th:each="color, i: ${colors}">
			                        		<input class="colors p-1 m-2" type="color"  th:value="${color}">
			                        		<input type="text" class="colorsName">
			                        		<input type="radio" name="colors" th:value="${color}" th:checked="${i.index == 0}">
		                        		</th:block>
		                        	</div>
	                        	</div>
	                        	<div th:unless="${colors != null}">
	                            	<span class="fs-5 fw-bold">ÏÉâÏÉÅ Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§.</span>
	                            </div>
	                        </li>
	                        <li class="fs-3 d-flex p-2 justify-content-between">
	                        	<div class="fw-bold">ÏàòÎüâ ÏÑ†ÌÉù</div>
	                        	<div class="quantity">
	                        		<input type="number" class="form-control" value="1" min="1" max="100" name="quantity">
	                        	</div>
	                        </li>
	                    </ul>
	                    <div class="p-2 col product_btns" aria-label="Large button group">
	                        <button type="button" class="btn btn-outline-info rounded-pill m-1" id="buyBtn">Íµ¨Îß§ÌïòÍ∏∞</button>
	                        <button type="button" class="btn btn-outline-info rounded-pill m-1" id="stampBtn">Ï∞úÌïòÍ∏∞</button>
	                        <button type="button" class="btn btn-outline-info rounded-pill m-1" id="putBtn">Ïû•Î∞îÍµ¨ÎãàÏóê Îã¥Í∏∞</button>
	                        <button type="button" class="btn btn-outline-info rounded-pill m-1" id="goToReply">Î¶¨Î∑∞ Î≥¥Í∏∞</button>
	                    </div>
               		</form>
                </div>
            </div>
            <div class="product-detail pt-4">
                <table class="table border" th:if="${p.usedStandard == 'Y'}">
                    <tr>
                        <th>ÏÇ¨Ïù¥Ï¶à Ï†ïÎ≥¥</th>
                        <th>S</th>
                        <th>M</th>
                        <th>L</th>
                        <th>XL</th>
                    </tr>
                    <tr>
                        <th>Î™∏Î¨¥Í≤å</th>
                        <td>2~3KG</td>
                        <td>4~5KG</td>
                        <td>5~7KG</td>
                        <td>5~7KG</td>
                    </tr>
                    <tr>
                        <th>CHEST</th>
                        <td>48cm</td>
                        <td>49cm</td>
                        <td>51cm</td>
                        <td>57cm</td>
                    </tr>
                    <tr>
                        <th>NECK</th>
                        <td>35cm</td>
                        <td>38cm</td>
                        <td>43cm</td>
                        <td>46cm</td>
                    </tr>
                </table>
                <div class="d-flex border-top border-bottom border-3 border-black row">
                    <div class="pt-2 pb-3 fw-bold fs-4">
                        ÏÉÅÌíà Ïú†ÏùòÏÇ¨Ìï≠
                    </div>
                    <div class="table-bordered m-2">
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>Ïû¨ÌôîÎì±Ïùò Î∞∞ÏÜ°Î∞©Î≤ïÏóê Í¥ÄÌïú Ï†ïÎ≥¥</span>
                            </div>
                            <div class="col-9">
                                <p>Î∞∞ÏÜ°Î∞©Ïãù Î∞è Ï∂úÍ≥†Ïùº Îì±ÏùÄ ÏÉÅÌíà ÏÉÅÏÑ∏ÌéòÏù¥ÏßÄ Ï∞∏Ï°∞</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>Ï£ºÎ¨∏ Ïù¥ÌõÑ ÏòàÏÉÅÎêòÎäî Î∞∞ÏÜ°Í∏∞Í∞Ñ</span>
                            </div>
                            <div class="col-9">
                                <p>Ï£ºÎ¨∏ÏùºÎ°úÎ∂ÄÌÑ∞ ÌèâÍ∑† 3Ïùº Ïù¥ÎÇ¥Ïóê Î∞úÏÜ° (Ï≤úÏû¨ÏßÄÎ≥Ä ÎòêÎäî ÏÉÅÌíà ÏàòÍ∏â ÏÉÅÌô©, ÌÉùÎ∞∞ÏÇ¨ ÏÇ¨Ï†ï Îì±Ïóê Îî∞Îùº ÏßÄÏó∞Îê† Ïàò ÏûàÏäµÎãàÎã§.)</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>Ï†úÌíàÌïòÏûê¬∑Ïò§Î∞∞ÏÜ° Îì±Ïóê Îî∞Î•∏ Ï≤≠ÏïΩÏ≤†Ìöå Îì±Ïùò Í≤ΩÏö∞ Ï≤≠ÏïΩÏ≤†Ìöå Îì±ÏùÑ Ìï† Ïàò ÏûàÎäî Í∏∞Í∞Ñ Î∞è ÌÜµÏã†ÌåêÎß§ÏóÖÏûêÍ∞Ä Î∂ÄÎã¥ÌïòÎäî Î∞òÌíàÎπÑÏö© Îì±Ïóê Í¥ÄÌïú Ï†ïÎ≥¥</span>
                            </div>
                            <div class="col-9">
                                <p>Ï†ÑÏûêÏÉÅÍ±∞ÎûòÎì±ÏóêÏÑúÏùòÏÜåÎπÑÏûêÎ≥¥Ìò∏ÏóêÍ¥ÄÌïúÎ≤ïÎ•† Îì±Ïóê ÏùòÌïú Ï†úÌíàÏùò ÌïòÏûê ÎòêÎäî Ïò§Î∞∞ÏÜ° Îì±ÏúºÎ°ú Ïù∏Ìïú Ï≤≠ÏïΩÏ≤†ÌöåÏùò Í≤ΩÏö∞ÏóêÎäî ÏÉÅÌíà ÏàòÎ†π ÌõÑ 3Í∞úÏõî Ïù¥ÎÇ¥, Í∑∏ ÏÇ¨Ïã§ÏùÑ Ïïà ÎÇ† ÎòêÎäî Ïïå Ïàò ÏûàÏóàÎçò ÎÇ†Î°úÎ∂ÄÌÑ∞ 30Ïùº Ïù¥ÎÇ¥Ïóê Ï≤≠ÏïΩÏ≤†ÌöåÎ•º Ìï† Ïàò ÏûàÏúºÎ©∞, Î∞òÌíà ÎπÑÏö©ÏùÄ ÌÜµÏã†ÌåêÎß§ÏóÖÏûêÍ∞Ä Î∂ÄÎã¥Ìï©ÎãàÎã§.</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>Ï†úÌíàÌïòÏûêÍ∞Ä ÏïÑÎãå ÏÜåÎπÑÏûêÏùò Îã®ÏàúÎ≥ÄÏã¨, Ï∞©Ïò§Íµ¨Îß§Ïóê Îî∞Î•∏ Ï≤≠ÏïΩÏ≤†Ìöå Îì±Ïùò Í≤ΩÏö∞ Ï≤≠ÏïΩÏ≤†Ìöå Îì±ÏùÑ Ìï† Ïàò ÏûàÎäî Í∏∞Í∞Ñ Î∞è ÏÜåÎπÑÏûêÍ∞Ä Î∂ÄÎã¥ÌïòÎäî Î∞òÌíàÎπÑÏö© Îì±Ïóê Í¥ÄÌïú Ï†ïÎ≥¥</span>
                            </div>
                            <div class="col-9">
                                <p>Ìé∏ÎèÑ 3,000 Ïõê (ÏµúÏ¥à Î∞∞ÏÜ°ÎπÑÍ∞Ä Î¨¥Î£åÏù∏ Í≤ΩÏö∞ ÏôïÎ≥µÏúºÎ°ú Î∂ÄÍ≥ºÎê† Ïàò ÏûàÏäµÎãàÎã§.)</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>Ï†úÌíàÌïòÏûêÍ∞Ä ÏïÑÎãå ÏÜåÎπÑÏûêÏùò Îã®ÏàúÎ≥ÄÏã¨, Ï∞©Ïò§Íµ¨Îß§Ïóê Îî∞Î•∏ Ï≤≠ÏïΩÏ≤†ÌöåÍ∞Ä Î∂àÍ∞ÄÎä•Ìïú Í≤ΩÏö∞ Í∑∏ Íµ¨Ï≤¥Ï†Å ÏÇ¨Ïú†ÏôÄ Í∑ºÍ±∞</span>
                            </div>
                            <div class="col-9">
                                <p>Ï†ÑÏûêÏÉÅÍ±∞ÎûòÎì±ÏóêÏÑúÏùò ÏÜåÎπÑÏûêÎ≥¥Ìò∏ÏóêÍ¥ÄÌïúÎ≤ïÎ•† Îì±Ïóê ÏùòÌïú Ï≤≠ÏïΩÏ≤†Ìöå Ï†úÌïú ÏÇ¨Ïú†Ïóê Ìï¥ÎãπÌïòÎäî Í≤ΩÏö∞ Î∞è Í∏∞ÌÉÄ Í∞ùÍ¥ÄÏ†ÅÏúºÎ°ú Ïù¥Ïóê Ï§ÄÌïòÎäî Í≤ÉÏúºÎ°ú Ïù∏Ï†ïÎêòÎäî Í≤ΩÏö∞ Ï≤≠ÏïΩÏ≤†ÌöåÍ∞Ä Ï†úÌïúÎê† Ïàò ÏûàÏäµÎãàÎã§.</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>Ïû¨Ìôî Îì±Ïùò ÍµêÌôò¬∑Î∞òÌíà¬∑Î≥¥Ï¶ù Ï°∞Í±¥ Î∞è ÌíàÏßàÎ≥¥Ï¶ùÍ∏∞Ï§Ä</span>
                            </div>
                            <div class="col-9">
                                <p>ÏÜåÎπÑÏûêÎ∂ÑÏüÅÌï¥Í≤∞Í∏∞Ï§Ä(Í≥µÏ†ïÍ±∞ÎûòÏúÑÏõêÌöå Í≥†Ïãú) Î∞è Í¥ÄÍ≥ÑÎ≤ïÎ†πÏóê Îî∞Î¶ÖÎãàÎã§.</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2" >
                            <div class="col-3 fw-bold">
                                <span>ÎåÄÍ∏àÏùÑ ÌôòÎ∂àÎ∞õÍ∏∞ ÏúÑÌïú Î∞©Î≤ïÍ≥º ÌôòÎ∂àÏù¥ ÏßÄÏó∞Îê† Í≤ΩÏö∞ ÏßÄÏó∞Ïóê Îî∞Î•∏ Î∞∞ÏÉÅÍ∏àÏùÑ ÏßÄÍ∏âÎ∞õÏùÑ Ïàò ÏûàÎã§Îäî ÏÇ¨Ïã§ Î∞è Î∞∞ÏÉÅÍ∏à ÏßÄÍ∏âÏùò Íµ¨Ï≤¥Ï†Å Ï°∞Í±¥ Î∞è Ï†àÏ∞®Ï§Ä</span>
                            </div>
                            <div class="col-9">
                                <p>Ï£ºÎ¨∏ Ï∑®ÏÜå Î∞è ÎåÄÍ∏àÏùò ÌôòÎ∂àÏùÄ ÎßàÏù¥ÌéòÏù¥ÏßÄÏóêÏÑú Ïã†Ï≤≠Ìï† Ïàò ÏûàÏúºÎ©∞, Ï†ÑÏûêÏÉÅÍ±∞Îûò Îì±ÏóêÏÑúÏùò ÏÜåÎπÑÏûêÎ≥¥Ìò∏Ïóê Í¥ÄÌïú Î≤ïÎ•†Ïóê Îî∞Îùº ÏÜåÎπÑÏûêÏùò Ï≤≠ÏïΩÏ≤†Ìöå ÌõÑ ÌåêÎß§ÏûêÍ∞Ä Ïû¨Ìôî Îì±ÏùÑ Î∞òÌôò Î∞õÏùÄ ÎÇ†Î°úÎ∂ÄÌÑ∞ 3ÏòÅÏóÖÏùº Ïù¥ÎÇ¥Ïóê ÏßÄÍ∏âÎ∞õÏùÄ ÎåÄÍ∏àÏùò ÌôòÍ∏âÏùÑ Ï†ïÎãπÌïú ÏÇ¨Ïú† ÏóÜÏù¥ ÏßÄÏó∞ÌïòÎäî ÎïåÏóêÎäî ÏÜåÎπÑÏûêÎäî ÏßÄÏó∞Í∏∞Í∞ÑÏóê ÎåÄÌï¥ÏÑú Ïó∞ 15%Ïùò ÏßÄÏó∞Î∞∞ÏÉÅÍ∏àÏùÑ ÌåêÎß§ÏûêÏóêÍ≤å Ï≤≠Íµ¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>ÏÜåÎπÑÏûêÌîºÌï¥Î≥¥ÏÉÅÏùò Ï≤òÎ¶¨, Ïû¨Ìôî Îì±Ïóê ÎåÄÌïú Î∂àÎßå Ï≤òÎ¶¨ Î∞è ÏÜåÎπÑÏûêÏôÄ ÏÇ¨ÏóÖÏûê ÏÇ¨Ïù¥Ïùò Î∂ÑÏüÅÏ≤òÎ¶¨Ïóê Í¥ÄÌïú ÏÇ¨Ìï≠</span>
                            </div>
                            <div class="col-9">
                                <p>ÏÜåÎπÑÏûêÎ∂ÑÏüÅÌï¥Í≤∞Í∏∞Ï§Ä(Í≥µÏ†ïÍ±∞ÎûòÏúÑÏõêÌöå Í≥†Ïãú) Î∞è Í¥ÄÍ≥ÑÎ≤ïÎ†πÏóê Îî∞Î¶ÖÎãàÎã§.</p>
                            </div>
                        </div>
                        <div class="d-flex pb-2">
                            <div class="col-3 fw-bold">
                                <span>Í±∞ÎûòÏóê Í¥ÄÌïú ÏïΩÍ¥ÄÏùò ÎÇ¥Ïö© ÎòêÎäî ÌôïÏù∏Ìï† Ïàò ÏûàÎäî Î∞©Î≤ï</span>
                            </div>
                            <div class="col-9">
                                <p>ÌéòÏù¥ÏßÄ ÌïòÎã®Ïùò Ïù¥Ïö©ÏïΩÍ¥Ä ÎßÅÌÅ¨Î•º ÌÜµÌï¥ ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="product_images pt-4 text-center">
                    <h1 class="pb-4">ÏÉÅÌíà ÏÉÅÏÑ∏Ï†ïÎ≥¥</h1>
                    <img class="h-auto m-2 p-2" style="width:98%" th:each="con: ${conList}" th:src="'/image/shopFiles/' + ${ con.renameName}">
                </div>
                <div class="reply mt-4 border-1 border-dark border-top">
                    <h1 class="pt-4 text-center">ÏÉÅÌíà Î¶¨Î∑∞</h1>
                    <div class="input-group">
                        <span class="input-group-text">Î¶¨Î∑∞<br>ÎÇ¥Ïö©</span>
                        <textarea class="form-control" rows="4" placeholder="ÏÜåÏ§ëÌïú Î¶¨Î∑∞Î•º ÎÇ®Í≤®Ï£ºÏÑ∏Ïöî." style="resize: none;" id="replyContent"></textarea>
                        <button type="button" class="btn btn-outline-success btn-lg" id="insertReply">Îì±Î°ù</button>                        
                    </div>                                           
                    
                    <!-- ÎåìÍ∏Ä Ï°∞Ìöå ÏòÅÏó≠ -->
                    <!-- Ï¢ãÏïÑÏöî Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏, ÎÇ¥ ÎåìÍ∏ÄÏù¥Î©¥ ÏàòÏ†ï ÏÇ≠Ï†ú -->
                    <div id="replyContents">
	                    <div class="comment-container d-flex mt-3 justify-content-center text-center border-top border-black replyOne" th:each="r: ${rList}">
	                    	<input type="hidden" th:value="${r.rNo}">
	                        <div class="col-1" style="line-height: 40px;">[[${r.mbNickName}]]</div>
	                        <div class="col-8 reContent" style="line-height: 40px;">[[${r.reContent}]]</div>
	                        <div class="col-1" style="line-height: 40px;">[[${r.reDate}]]</div>
	                        <div class="col-2 d-flex align-items-center justify-content-end m-1 utility" name="devDiv">
	                        	<div class="mx-2">
	                        		[[${r.reLike}]]
	                        	</div>
	                        	<div class="changeImage">
								    <th:block th:if="${r.userLiked}">
								        <!-- ÏÇ¨Ïö©ÏûêÍ∞Ä Ï¢ãÏïÑÏöîÎ•º ÎàÑÎ•∏ Í≤ΩÏö∞ -->
								        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="black" viewBox="0 0 16 16">
								            <path d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
								        </svg>
								    </th:block>
								    <th:block th:unless="${r.userLiked}">
								        <!-- ÏÇ¨Ïö©ÏûêÍ∞Ä Ï¢ãÏïÑÏöîÎ•º ÎàÑÎ•¥ÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ -->
								        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="white" viewBox="0 0 16 16">
								            <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"/>
								        </svg>
								    </th:block>
								</div>
	
		                        <div class="dropend  me-2">
		                        	<button type="button" class="btn drop-btn" aria-expanded="false">
			                            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
			                                <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
			                            </svg>
		                            </button>
		                            <ul class="drop-menu">
		                                <li><button class="drop-item" data-bs-toggle="modal" data-bs-target="#modal1">Ïã†Í≥†</button></li>
		                                <th:block th:if="${ session.loginUser != null && session.loginUser.mbId == r.mbId}">
			                                <li><button class="drop-item replyUpdate" type="button">ÏàòÏ†ï</button></li>
			                                <li><button class="drop-item replyDelete" type="button">ÏÇ≠Ï†ú</button></li>
		                                </th:block>
		                            </ul>
		                        </div>
	                        </div>
	                    </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    
    
    <!-- Ïã†Í≥† Î™®Îã¨ -->
    <div class="modal fade" tabindex="-1" role="dialog" id="confirm">
        <div class="modal-dialog" role="document">
            <div class="modal-content rounded-1 shadow">
                <div class="modal-body p-4 text-center fs-4 fw-bold">
                	
                </div>
                <div class="modal-body p-2 fw-bold fs-6">
                
                </div>
                <div class="modal-footer flex-nowrap p-1">
                    <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0 border-end" id="submitForm">
                        <strong>ÎÑ§</strong>
                     </button>
                     <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0" data-bs-dismiss="modal">ÏïÑÎãàÏò§</button>
                </div>
            </div>
        </div>
    </div>
    
</body>
<script th:inline="javascript">

	let oldData;
	window.onload = () =>{

		/*<![CDATA[*/
		const p = /*[[${p}]]*/1;
		const loginUser = /*[[${session.loginUser}]]*/1;
		let savedCount = /*[[${savedCount}]]*/1; 
		let reviewCount = /*[[${rList.size}]]*/1;
		/*]]>*/
		
        window.addEventListener('scroll', function () {
            var scrollY = window.scrollY || document.documentElement.scrollTop;

            // ÏùºÏ†ï yÏ∂ï Ï¢åÌëúÎ•º Í∏∞Ï§ÄÏúºÎ°ú ÌôïÏù∏
            var triggerY = 950; // Ï°∞Ï†ï Í∞ÄÎä•

            // yÏ∂ï Ï¢åÌëúÍ∞Ä triggerY Ïù¥ÏÉÅÏù¥Î©¥ fixed-topÏúºÎ°ú Î≥ÄÍ≤Ω, Í∑∏Î†áÏßÄ ÏïäÏúºÎ©¥ Í∏∞Î≥∏ ÏÉÅÌÉúÎ°ú ÎêòÎèåÎ¶º
            if (scrollY > triggerY) {
                document.querySelector('.product_btns').classList.add('fixed-top');
            } else {
                document.querySelector('.product_btns').classList.remove('fixed-top');
            }
        });
        
        // ÎÇ¥Ïùº ÎÇ†Ïßú Í≥ÑÏÇ∞
        const deli = document.getElementById('deli');
        const today = new Date();
        const day = today.getMonth()+1  + "Ïõî " 
					+ (today.getDate()+1)  + "Ïùº";
        
        deli.innerHTML = "ÎÇ¥Ïùº " + day + " ÎèÑÏ∞© ÏòàÏ†ï";
        
        const isMove = document.getElementById('isMove');
		const form = document.getElementById('productForm');
		const quantity = document.getElementsByClassName('quantity')[0].querySelector('input');
		document.getElementById('buyBtn').addEventListener('click', () =>{
			if(loginUser != null) {
				if(quantity.value > 100) {
					alert("ÏàòÎüâÏùÄ 100Í∞úÎ•º ÎÑòÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.");
					quantity.focus();
					event.preventDefault();
				} else {
					isMove.value = 'Y';
					form.action = '/shop/payment';
					form.submit();
				}
			} else {
				alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
			}
			
			
		});
		
		if(loginUser?.isAdmin == 'Y') {
			document.getElementById('editBtn').addEventListener('click', () => {
				form.action = '/shop/moveToUpdate';
				form.submit();
			});
		}
		
		
		document.getElementById('putBtn').addEventListener('click', () =>{
			// Ïû•Î∞îÍµ¨ÎãàÏóê insertÎßå Ìï¥ÎÜìÍ∏∞ ÏóêÏù¥ÏûëÏä§Î°ú ÏÑ±Í≥µ Ïãú ÏïåÎüøÏ∞Ω Ï†ïÎèÑ?
			if(loginUser != null) {
				if(quantity.value > 100){
					alert("ÏàòÎüâÏùÄ 100Í∞úÎ•º ÎÑòÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.");
					quantity.focus();
					event.preventDefault();
				} else {
					isMove.value = 'N';
					
					let selectedSize;
					let selectedColor;
					if(p.usedStandard == 'Y'){
						const sizeRadio = document.getElementsByClassName('sizeSelect')[0].querySelectorAll('input');
						for(const selectRadio of sizeRadio) {
							if(selectRadio.checked) {
								selectedSize = selectRadio.value;
								break;
							}
						}
					}
					if(p.color != 'N') {
				        const colorRadio = document.getElementsByClassName('colorSelect')[0].querySelectorAll('input');
				        for(const selectRadio of colorRadio){
				        	if(selectRadio.checked){
				        		selectedColor = selectRadio.value;
				        		break;
				        	}
				        }
					}
					
					$.ajax({
						url: '/shop/payment',
						data: {productId:/*[[${p.productId}]]*/9999, pSize: selectedSize == undefined ? "N" : selectedSize, colors: selectedColor == undefined ? "N" : selectedColor, quantity:quantity.value, isMove:isMove.value},
						success: data => {
							if(data == 'success') {
								/*<![CDATA[*/
								alert(/*[[${p.productName}]]*/'name' + "  " + quantity.value + "Í∞úÍ∞Ä Ïû•Î∞îÍµ¨ÎãàÏóê Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.");
								/*]]>*/
							} else {
								aleet("Ïû•Î∞îÍµ¨Îãà Ï∂îÍ∞ÄÏóê Ïã§Ìå®ÌïòÏó¨ ÌéòÏù¥ÏßÄÍ∞Ä ÏÉàÎ°úÍ≥†Ïπ®Îê©ÎãàÎã§.");
								location.reload();
							}
						},
						error: data => {
							console.log(data);
						}
					});
				}
			} else {
				alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
			}
		});
		
		
		document.getElementById('stampBtn').addEventListener('click', () => {
			const sip = document.getElementById('stampImgParent');
			const stampWord = sip.children[0].children[1];
			const stampImg = sip.children[0].children[2];
			if(loginUser != null){
				if(stampImg.classList.contains('isEmpty')) {
					$.ajax({
						url: "/shop/insertStampProduct",
						data: {mbId:loginUser.mbId, pId:p.productId, type:'P'},
						success: data => {
							console.log(data);
							if(data == 'success'){
								savedCount = savedCount + 1
								stampWord.innerText = 'Ï∞úÌïòÍ∏∞ : ' + savedCount + 'Í±¥';
								stampImg.innerText = '‚ù§';
								stampImg.classList.remove('isEmpty');
								stampImg.classList.add('isFill');
							} else {
								alert("ÏïåÏàò ÏóÜÎäî Ïò§Î•òÍ∞Ä Î∞úÏÉùÌïòÏó¨ ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®Ìï©ÎãàÎã§.");
								location.reload();
							}
						},
						error: data => {
							console.log(data);
						}
					});	
				}
				
				if(stampImg.classList.contains('isFill')){
					$.ajax({
						url: "/shop/deleteStampProduct",
						data: {mbId:loginUser.mbId, pId:p.productId, type: 'P'},
						success: data => {
							console.log(data);
							if(data == 'success'){
								savedCount = savedCount - 1
								stampWord.innerText = 'Ï∞úÌïòÍ∏∞ : ' + savedCount + 'Í±¥';
								stampImg.innerText = 'ü§ç';
								stampImg.classList.remove('isFill');
								stampImg.classList.add('isEmpty');
							} else {
								alert("ÏïåÏàò ÏóÜÎäî Ïò§Î•òÍ∞Ä Î∞úÏÉùÌïòÏó¨ ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®Ìï©ÎãàÎã§.");
								location.reload();
							}
						},
						error: data => {
							console.log(data);
						}
					})
				}
					
			} else {
				alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
			}
		});
		
		
		
		function colorNameMath(color) {
        	var match = ntc.name(color);
        	const colorName = match[1];
        	return colorName;
        }
        
		const colorsName = document.getElementsByClassName('colorsName');
		/*<![CDATA[*/
		
		let colors = /*[[${colors}]]*/1;
		if(colors == null) {
			colors = 'N';
		}
		
		if(colors != 'N') {
			let i = 0;
			for(const color of colors) {
				const colorName = colorNameMath(color);
				colorsName[i].value = colorName;
				i++;
			}
		}
			
		/*]]>*/
		
		// Î¶¨Î∑∞ Î∞îÎ°ú Î≥¥Îü¨Í∞ÄÍ∏∞
		document.getElementById('goToReply').addEventListener('click', () =>{
			document.getElementById('replyContent').focus();			
		})
        
        // ÎåìÍ∏Ä ÏãúÏûë
        const insertBtn = document.getElementById('insertReply');
        
		const topReply = document.getElementById('replyContents');
		const reviewWord = document.getElementsByClassName('reviewWord')[0];
        /*<![CDATA[*/
		$(document).on('click', '#insertReply', function() {
			// Î°úÍ∑∏Ïù∏ Ïú†Ï†Ä Îã§Î£®Îäî Î°úÏßÅ ÏßúÍ∏∞
			const textarea = document.getElementById('replyContent');
			const replyContent = textarea.value;
			const p = /*[[${p}]]*/2;
			const boardNo = p.productId;
			const loginUserId = /*[[${ session.loginUser?.mbId}]]*/id;
			
			textarea.value = '';
			
			if(replyContent != '' && loginUserId != null) {
				$.ajax({
					url: '/shop/insertReply',
					data: {reContent:replyContent, bNo:boardNo, mbId:loginUserId},
					success: data => {
						topReply.innerHTML = '';
						for(const r of data.rList){
							const isLiked = r.userLiked;
							
							const newReply = `
								<div class="comment-container d-flex mt-3 justify-content-center text-center border-top border-black replyOne">
			                    	<input type="hidden" value="${r.rNo}">
			                        <div class="col-1" style="line-height: 40px;">${r.mbNickName}</div>
			                        <div class="col-8 reContent" style="line-height: 40px;">${r.reContent}</div>
			                        <div class="col-1" style="line-height: 40px;">${r.reDate}</div>
			                        <div class="col-2 d-flex align-items-center justify-content-end m-1 utility" name="devDiv">
			                        	<div class="mx-2">
			                        		${r.reLike}
			                        	</div>
			                        	<div class="changeImage">
			                        		${isLiked ? 
				                                `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="black" viewBox="0 0 16 16">
				                                    <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
				                                </svg>`
		                        				: 
				                                `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="white" viewBox="0 0 16 16">
				                                    <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"/>
				                                </svg>`
			                        		}
			                        	</div>
			
				                        <div class="dropend me-2">
					                        <button type="button" class="btn drop-btn" aria-expanded="false">
					                            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
					                                <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
					                            </svg>
											</button>
				                            <ul class="drop-menu">
				                                <li><button class="drop-item" data-bs-toggle="modal" data-bs-target="#modal1">Ïã†Í≥†</button></li>
				                                <th:block th:if="${ loginUser != null && loginUser.mbId == r.mbId}">
				                                ${loginUser != null && loginUser.mbId == r.mbId ? ` 
					                                <li><button class="drop-item replyUpdate" type="button">ÏàòÏ†ï</button></li>
					                                <li><button class="drop-item replyDelete" type="button">ÏÇ≠Ï†ú</button></li>
					                                `
					                                :
					                                ``	
				                                }
				                                </th:block>
				                            </ul>
				                        </div>
			                        </div>
		                    	</div>
								`;
							
							topReply.innerHTML += newReply;
							
						}
						reviewCount = reviewCount + 1;
						reviewWord.innerText = 'Î¶¨Î∑∞ : ' + reviewCount + 'Í±¥';
						
					},
					error : data => {
						console.log(data);
					}
					
				})
			} else {
				alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
			}
		});
        /*]]>*/
        // Î∞õÏïÑÏò§Îäî Îç∞Ïù¥ÌÑ∞ userLikedÎ°ú ÎπÑÍµê 
        // Î≥∏Î¨∏ÏúºÎ°ú ÏÉùÍ∏∞Îäî Í≤ÄÏ†ïÏÉâ ÌïòÌä∏ Ï†êÍ≤Ä
        topReply.addEventListener('click', function(event){
        	let target = event.target;
        	const changeDiv = target.closest('.changeImage');
        	const dropEnd = target.closest('.drop-btn');
        	const updateBtn = target.closest('.replyUpdate');
        	const deleteBtn = target.closest('.replyDelete');
        	const newUpdate = target.closest('.newUpdate');
        	const rollback = target.closest('.rollback');
        	//let isOut = true;
        	if(changeDiv) {
        		if(loginUser != null) {
        			const svg = changeDiv.children[0];
                	const isWhite = svg.classList.contains('white');
                	const isBlack = svg.classList.contains('black');
                	const rNo = changeDiv.parentElement.parentElement.children[0].value;
                	let likeDiv = changeDiv.parentElement.children[0];
                	let like = parseInt(likeDiv.innerText);
                	
                	if(isWhite || isBlack){
                		const ajaxURL = isWhite ? "/shop/insertReplyCount" : "/shop/downReplyCount";
                		$.ajax({
                			url: ajaxURL,
                			data: {mId:loginUser.mbId, rNo:rNo},
                			success: data => {
                				svg.classList.toggle('white');
                				svg.classList.toggle('black');
                				
                				if(isWhite) {
          						  svg.innerHTML = `<path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>`;
    	      					} else {
    	      						svg.innerHTML = `<path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"/>`;
    	      					}
                				
                				like = isWhite ? like + 1 : like - 1;
                				likeDiv.innerText = like;
                			},
                			error: data => {
                				console.log(data)
                			}
                		});
                	}
        		} else {
        			alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
        		}
        		
        	}
        	
        	if(dropEnd) {
        		const menu = dropEnd.parentElement.children[1];
        		menu.classList.toggle('show');
        	}
        	
        	
        	if(updateBtn) {
        		const replyRow = updateBtn.closest('.utility').parentElement;
        		const reConArea = replyRow.children[2];
        		oldData = reConArea.innerText;
        		reConArea.innerHTML = '<div class="d-flex mt-1 px-2" width="85%"><input type="text" class="form-control p-5 newContent" value="' + oldData + '"><div class="row"><button type="button" class="btn btn-sm btn-success newUpdate">Ï†úÏ∂ú</button><button type="button" class="btn btn-sm btn-light rollback">Ï∑®ÏÜå</button></div></div>';
        		
        		updateBtn.parentElement.parentElement.classList.remove('show');
        	}
        	
        	if(newUpdate) {
        		const newContent = newUpdate.parentElement.previousElementSibling.value;
        		const updateNo = newUpdate.closest('.replyOne').children[0].value;
        		const reConArea = newUpdate.closest('.reContent');
        		if(newContent != '' && loginUser != null) {
        			$.ajax({
        				url: '/shop/updateReply',
        				data: {rNo: updateNo, reContent:newContent},
        				success: data => {
        					if(data == 'success'){
        						reConArea.innerHTML = newContent;
        						oldData = '';
        					}
        				},
        				error: data => {
        					console.log(data);
        				}
        			});
        		}
        	}
        	
        	if(rollback) {
        		const reConArea = rollback.closest('.reContent');
        		reConArea.innerHTML = oldData;
        	}
        	
        	if(deleteBtn) {
        		const rNo = deleteBtn.closest('.replyOne').children[0].value;
        		const rContent = deleteBtn.closest('.replyOne').children[2].innerText;
        		const modal = document.getElementById('confirm');
        		deleteBtn.parentElement.parentElement.classList.remove('show');
        		
        		const modalBody = modal.querySelectorAll('.modal-body');
        		modalBody[0].innerHTML = "Î¶¨Î∑∞ ÏÇ≠Ï†ú Ïãú Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§. <br> Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?";
        		modalBody[1].innerHTML = "Î¶¨Î∑∞ ÎÇ¥Ïö© : " + rContent + "<input type='hidden' value='" + rNo + "'>";
        		
        		$('#confirm').modal('show');
        	}
        	
        })
        
        const submitModal = document.getElementById('submitForm');
        submitModal.addEventListener('click', function(){
        	
        	const rNo = this.parentElement.previousElementSibling.querySelector('input').value;
        	
        	$('#confirm').modal('hide');
        	$.ajax({
        		url:'/shop/deleteReply',
        		data: {rNo:rNo},
        		success: data => {
        			// Îç∞Ïù¥ÌÑ∞ ÏÑ±Í≥µ Ïãú ÏïåÎüøÏ∞Ω
        			if(data == 'success'){
        				alert("Î¶¨Î∑∞Í∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.");
        				location.reload();
        			}
        		},
        		error: data => {
        			console.log(data);
        		}
        	
        	})
        })
	}
        
</script>
</html>