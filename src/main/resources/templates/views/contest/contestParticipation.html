<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>WOOFLY</title>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<link rel="icon" href="image/woofly.png">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
	crossorigin="anonymous">

<link rel="stylesheet" type="text/css" th:href="@{/css/yh/contestParticipation.css}" /> 
</head>
<body>
   <div th:replace="~{common/top :: top}"></div>
	<main>
		<form action="/contest/contestEnroll" method="POST">
			<div class="container-fluid d-flex mx-5">
				
				<!-- 관리자만 보이게!!!!!!!!!!!!!!!!!!! -->
				<div th:replace="~{common/adminNav :: adminNav}"></div>
				
				<div class="col-10 b-5">
				 <div class="container mt-4">
				  <div class="row">
				   <div class="col-md-12 mb-4">
				    <div class="card">
						<div class="card-header">
							<h4>콘테스트 참가</h4>
						</div>
						<div class="card-body">
							<table class="table">
								<tbody>
									<tr>
										<th>제목</th>
										<td>
											<input class="form-control" type="text" aria-label="default input example" placeholder="제목" name="pTitle">
										</td>
									</tr>                                                   
									<tr>
										<th>강아지이름</th>
										<td>
											<input class="form-control" type="text" aria-label="default input example" placeholder="강아지이름" name="pPet">
										</td>
									</tr>
									<tr>
										<th>내용</th>
										<td>
											<textarea class="form-control" rows="6" placeholder="내용" style="resize: none;" name="pContent"></textarea>
										</td>
									</tr>
									<tr>
										<th>사진</th>
										<td>															
									        <div id="fileArea">
									        	<div class="mb-3">
									        		<input type="file" class="form-control form-control-sm" name="file">
									        	</div>
									        </div>
									        <button type="button" class="w-15 btn btn-outline-dark" id="addFile">+ 사진추가</button>
										</td>
									</tr>
									<tr>
										<th>검색 <button type="button" class="btn btn-sm  rounded-2 btn-outline-dark" id="modalLink" style="margin-left: 65%">검색</button></th>
										<td>
											<div id="td">
											</div>
										</td>
									</tr>
								</tbody>
							</table>
							<div class="container text-center">
								<button class="btn btn-lg fs-10 col-2 m-0 rounded-2 btn-outline-primary">등록</button>
								<button type="button" class="btn btn-lg fs-10 col-2 m-0 rounded-2 btn-outline-dark">이전</button>
							</div>
						</div>	
				    </div>
				   </div>
				  </div>                    
				 </div>
				</div>
			</div>
		</form> 
		<div id="modalLayer" >
			<div class="modalContent">
				<button type="button" class="btn-close" aria-label="Close" id="modalLink"> </button>		
				<br>
				<form action="/contest/searchItem">
					<span style="margin-left: 20%;">애완용품</span>
					<div style="display: inline-block; margin-left: 40px;" >
						<input type="text" placeholder="검색" name="search">
					</div>
					<div style="display: inline-block; margin-left: 30px;">
						<input class="btn btn-sm btn-outline-dark" type="submit" value="검색" >
					</div>
				</form>
				<table class="table" style="margin-top: 20px;">
					<thead>
						<tr>
							<th scope="col" >#</th>
							<th scope="col">사진</th>
							<th scope="col">애완용품명</th>
							<th scope="col">선택</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="l : ${itemList}">
							<th scope="row">[[${l.orderDetailId}]]</th>
							<td><input type="image" alt="사진"></td>
							<td>[[${l.productName}]]</td>
							<td><input type="checkbox" style="width: 20px; height: 20px;" class="checkbox"></td>
						</tr>
					</tbody>
				</table>
				<div style="text-align: center;">
	 				<input class="btn btn-outline-dark" type="button" value="등록" onclick="register()">			
				</div>
			</div>
		</div>
    </main>
	
	<script>
		$(document).ready(function(){
			var modalLayer = $("#modalLayer");
			var modalLink = $("#modalLink");
			var modalCont = $(".modalContent");
			var marginLeft = modalCont.outerWidth()/2;
			var marginTop = modalCont.outerHeight()/2; 
		
		
			modalLink.click(function(){
				modalLayer.fadeIn("slow");
				modalCont.css({"margin-top" : -marginTop, "margin-left" : -marginLeft});
				$(this).blur();
				$(".modalContent > a").focus(); 
				return false;
			});
			
			$(".modalContent > button").click(function(){
				modalLayer.fadeOut("slow");
				modalLink.focus();
			});		
		});
	
		window.onload = () =>{
			const fileArea = document.querySelector('#fileArea');
			document.getElementById('addFile').addEventListener('click', () =>{
				const newDiv = document.createElement('div');
				newDiv.classList.add('mb-3');
				newDiv.innerHTML = '<input type="file" class="form-control form-control-sm" name="file">';
				
				fileArea.append(newDiv);
				
			});
		}	
		
		function register() {
		    const checkboxes = document.querySelectorAll('.checkbox');
		    const selectedItems = [];

		    checkboxes.forEach((checkbox, index) => {
		        if (checkbox.checked) {
		            const productName = document.querySelectorAll('td:nth-child(3)')[index].textContent;
		            selectedItems.push(productName);
		        }
		    });

		    const tdDiv = document.getElementById('td');
		    
		    for (let i = 0; i < selectedItems.length; i++) {
		        const a = selectedItems[i];
		        const newDiv = document.createElement('div'); // Create a new div element for content
		        const newCheckbox = document.createElement('input'); // Create a new checkbox
		        
		        // Set up the checkbox
		        newCheckbox.type = 'checkbox';
		        newCheckbox.className = 'checkbox'; // You may adjust the class name if needed

		        // Set the content and append to the 'td' div
		        newDiv.textContent = a;
		        newDiv.prepend(newCheckbox); // Add checkbox before the text
		        tdDiv.appendChild(newDiv); // Append it to the 'td' div
		    }
		    
		    
		}
		
	</script>

	
</body>
</html>